'''
Use of this source code is governed by a MIT-style license that can be found in the LICENSE file.
Created on Feb 9, 2017
@author: Niels Lubbes
'''
from ns_lattice import *

class TestNSBasis:

    def test__get_base_changes__rank3( self ):
        mat_lst = get_base_changes( 3 )

        chk_lst = []
        chk_lst += [ [( 1, -1, 0 ), ( 1, 0, -1 ), ( 1, -1, -1 )] ]
        chk_lst += [ [( 1, 0, 0 ), ( 0, 0, 1 ), ( 0, 1, 0 )] ]
        chk_lst += [ [( 1, 0, 0 ), ( 0, 1, 0 ), ( 0, 0, 1 )] ]

        assert mat_lst == [ matrix( chk ) for chk in chk_lst ]


    def test__get_base_changes__rank3_12( self ):
        mat_lst = get_base_changes( 3, [Div( [0, 1, -1] )] )

        chk_lst = []
        chk_lst += [ [( 1, 0, 0 ), ( 0, 1, 0 ), ( 0, 0, 1 )] ]

        assert mat_lst == [ matrix( chk ) for chk in chk_lst ]


    def test__get_base_changes__rank4( self ):
        mat_lst = get_base_changes( 4 )

        chk_lst = []
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, 0, -1, -1 ), ( 1, -1, 0, -1 ), ( 1, -1, -1, 0 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, -1, 0, -1 ), ( 1, 0, -1, -1 ), ( 1, -1, -1, 0 )] ]
        chk_lst += [ [( 1, -1, 0, 0 ), ( 1, 0, -1, 0 ), ( 0, 0, 0, 1 ), ( 1, -1, -1, 0 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, 0, -1, -1 ), ( 1, -1, -1, 0 ), ( 1, -1, 0, -1 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, -1, -1, 0 ), ( 1, 0, -1, -1 ), ( 1, -1, 0, -1 )] ]
        chk_lst += [ [( 1, -1, 0, 0 ), ( 1, 0, 0, -1 ), ( 0, 0, 1, 0 ), ( 1, -1, 0, -1 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, -1, 0, -1 ), ( 1, -1, -1, 0 ), ( 1, 0, -1, -1 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, -1, -1, 0 ), ( 1, -1, 0, -1 ), ( 1, 0, -1, -1 )] ]
        chk_lst += [ [( 1, 0, -1, 0 ), ( 1, 0, 0, -1 ), ( 0, 1, 0, 0 ), ( 1, 0, -1, -1 )] ]
        chk_lst += [ [( 1, 0, -1, 0 ), ( 1, 0, 0, -1 ), ( 1, 0, -1, -1 ), ( 0, 1, 0, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 0, 0, 1 ), ( 0, 0, 1, 0 ), ( 0, 1, 0, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 0, 1, 0 ), ( 0, 0, 0, 1 ), ( 0, 1, 0, 0 )] ]
        chk_lst += [ [( 1, -1, 0, 0 ), ( 1, 0, 0, -1 ), ( 1, -1, 0, -1 ), ( 0, 0, 1, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 0, 0, 1 ), ( 0, 1, 0, 0 ), ( 0, 0, 1, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 1, 0, 0 ), ( 0, 0, 0, 1 ), ( 0, 0, 1, 0 )] ]
        chk_lst += [ [( 1, -1, 0, 0 ), ( 1, 0, -1, 0 ), ( 1, -1, -1, 0 ), ( 0, 0, 0, 1 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 0, 1, 0 ), ( 0, 1, 0, 0 ), ( 0, 0, 0, 1 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 1, 0, 0 ), ( 0, 0, 1, 0 ), ( 0, 0, 0, 1 )] ]

        assert mat_lst == [ matrix( chk ) for chk in chk_lst ]


    def test__get_base_changes__rank4_12( self ):
        mat_lst = get_base_changes( 4, [Div( [0, 1, -1, 0] )] )

        chk_lst = []
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, 0, -1, -1 ), ( 1, -1, 0, -1 ), ( 1, -1, -1, 0 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, 0, -1, -1 ), ( 1, -1, -1, 0 ), ( 1, -1, 0, -1 )] ]
        chk_lst += [ [( 1, -1, 0, 0 ), ( 1, 0, 0, -1 ), ( 0, 0, 1, 0 ), ( 1, -1, 0, -1 )] ]
        chk_lst += [ [( 2, -1, -1, -1 ), ( 1, -1, -1, 0 ), ( 1, 0, -1, -1 ), ( 1, -1, 0, -1 )] ]
        chk_lst += [ [( 1, -1, 0, 0 ), ( 1, 0, 0, -1 ), ( 1, -1, 0, -1 ), ( 0, 0, 1, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 1, 0, 0 ), ( 0, 0, 0, 1 ), ( 0, 0, 1, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 0, 0, 1 ), ( 0, 1, 0, 0 ), ( 0, 0, 1, 0 )] ]
        chk_lst += [ [( 1, 0, 0, 0 ), ( 0, 1, 0, 0 ), ( 0, 0, 1, 0 ), ( 0, 0, 0, 1 )] ]

        assert mat_lst == [ matrix( chk ) for chk in chk_lst ]


